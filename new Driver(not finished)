#include "Map.h"
#include "MapLoader.h"
#include "bidding.h"
#include <iostream>
#include "Player.h"
#include "Card.h"
#include<vector>
using namespace std;

int main(){
    MapLoader( string "map1", int num);//load map

    //---------------------------------------------------------------------------parts1---------------------------------------------------------//
    int numberOfPlayer = 0, coin = 0,bid = 0, index = 0;
    int static poll;
    string name = "";
    vector<BPlayer*> player;
    cout<< "How many players do you have ?"<< endl;
    cin >> numberOfPlayer;
    while (numberOfPlayer < 2 || numberOfPlayer > 4) {
        cout << "The value is not valid!" << endl;
        cin >> numberOfPlayer;
    } //check numbers of player
    
    if (numberOfPlayer == 4) 
        coin = 9;
    if (numberOfPlayer == 3) 
        coin = 11;
    if (numberOfPlayer == 2) 
        coin = 14;
    
    Deck* dk = new Deck();//creat the deck 
    dk->generateDeck();//generate the deck
    Hand* hand = new Hand(dk);//drwa the 6 face-up card from the deck

    
    for (int i = 1; i <= numberOfPlayer; i++) {
        cout << i << " " << " what is your name ? " << endl;
        cin >> name;
        Player* p = new Player();//armis and cities have been initialed by player constrcutor
        p->setName(name);
        p->setCoin(coin);
        
        


        cout << " what index of card do u want" << endl;
        cin >> index;
        p->SetHandCard(hand->exchange(index));//select the card from the row
        p->PayCoin(getCardCost(index));//pay the coin of that card
        poll =+ getCardCost(index);// put it at the top of the board

        cout << "How much would you like to bid ? " << endl;//assign bidding facility
        cin>> bid;
        while(bid>coin||bid<0){
            cout << "the value is not correct, reenter! " << endl;
            cin>> bid;
        }
        p->getBidFacility()->setBid(bid);
        
        player.push_back(p);
    }
    //------------------------------------------------------part 2---------------------------------------------------//
    
    //Player *player1 = new Player("yudan", 3);
    //Player *player2 =new Player("yuwan", 4);
    //Player *player3 =new Player("yuHan", 3);
    //Player *player4 = new Player("yuluan", 6); 
    
    //player.push_back(player1);
    //player.push_back(player2);
    //player.push_back(player3);
    //player.push_back(player4);
    //for(int i = 0;i<player.size();i++){
        //cout <<" the result is :"<< player[i]->getName()<<  player[i]->getBidFacility()->getBid()  <<endl;
    //}
    cout <<" the winner is :"<< player[bidding::biddingFacility(player)]->getName() <<endl;
    return 0;
}
